CREATE DATABASE QLDeTai;

GO

USE QLDeTai;

GO

/* tạo bảng giáo viên */ 
CREATE TABLE GIAOVIEN (
	MAGV CHAR(3),
	HOTEN NVARCHAR(20),
	LUONG FLOAT,
	PHAI NVARCHAR(3),
	CHECK (PHAI IN ('Nam',N'Nữ')),
	NGAYSINH DATE,
	DIACHI NVARCHAR(50),
	GVQLCM CHAR(3),
	MABM NVARCHAR(5),
	PRIMARY KEY (MAGV),
	FOREIGN KEY (GVQLCM) 
REFERENCES GIAOVIEN(MAGV)
)

GO

/* tạo bảng giáo viên đề tài */ 
CREATE TABLE GV_DT (
	MAGV CHAR(3),
	DIENTHOAI CHAR(10),
	PRIMARY KEY (MAGV, DIENTHOAI),
	FOREIGN KEY (MAGV) 
REFERENCES GIAOVIEN(MAGV)
)

GO

/* tạo bảng khoa */ 
CREATE TABLE KHOA (
	MAKHOA VARCHAR(4),
	PRIMARY KEY (MAKHOA),
	TENKHOA NVARCHAR(20),
	NAMTL CHAR(4),
	PHONG CHAR(3),
	DIENTHOAI CHAR(10),
	TRUONGKHOA CHAR(3),
	FOREIGN KEY (TRUONGKHOA)
REFERENCES GIAOVIEN(MAGV),
	NGAYNHANCHUC DATE
)

GO

/* tạo bảng bộ môn */ 
CREATE TABLE BOMON (
	MABM NVARCHAR(5),
	PRIMARY KEY(MABM),
	TENBM NVARCHAR(20),
	PHONG CHAR(3),
	DIENTHOAI CHAR(10),
	TRUONGBM CHAR(3),
	FOREIGN KEY (TRUONGBM)
REFERENCES GIAOVIEN(MAGV),
	MAKHOA VARCHAR(4),
	FOREIGN KEY (MAKHOA)
REFERENCES KHOA(MAKHOA),
	NGAYNHANCHUC DATE
)

GO

 /* thêm khóa ngoại cho GIAOVIEN */ 
 ALTER TABLE GIAOVIEN 
  ADD CONSTRAINT FK_GIAOVIEN_BOMON 
  FOREIGN KEY (MABM)
REFERENCES BOMON(MABM)
GO

CREATE TABLE NGUOITHAN (
	MAGV CHAR(3),
	TEN NVARCHAR(20),
	NGAYSINH DATE,
	PHAI NVARCHAR(3),
	CHECK (PHAI IN ('Nam',N'Nữ')),
	PRIMARY KEY (MAGV, TEN),
	FOREIGN KEY (MAGV)
REFERENCES GIAOVIEN(MAGV)
)

GO

CREATE TABLE CHUDE (
	MACD NVARCHAR(5),
	PRIMARY KEY (MACD),
	TENCD NVARCHAR(50)
)

GO

CREATE TABLE DETAI (
	MADT CHAR(3),
	PRIMARY KEY(MADT),
	TENDT NVARCHAR(50),
	CAPQL NVARCHAR(20),
	KINHPHI FLOAT,
	NGAYBD DATE,
	NGAYKT DATE,
	MACD NVARCHAR(5),
	FOREIGN KEY (MACD) 
REFERENCES CHUDE(MACD),
	GVCNDT CHAR(3),
	FOREIGN KEY (GVCNDT)
REFERENCES GIAOVIEN(MAGV)
)
GO

CREATE TABLE CONGVIEC(
	MADT CHAR(3),
	SOTT INT,
	PRIMARY KEY(MADT, SOTT),
	TENCV NVARCHAR(50),
	NGAYBD DATE,
	NGAYKT DATE,
	FOREIGN KEY (MADT)
REFERENCES DETAI(MADT)
)
GO


CREATE TABLE THAMGIADT(
	MAGV CHAR(3),
	MADT CHAR(3),
	STT INT,
	PRIMARY KEY(MAGV, MADT, STT),
	PHUCAP FLOAT,
	KETQUA NVARCHAR(10),
	FOREIGN KEY (MAGV) 
REFERENCES GIAOVIEN(MAGV),
	FOREIGN KEY (MADT,STT)
REFERENCES CONGVIEC(MADT,SOTT)
)
GO




/*Nhập liệu cho bảng GIAOVIEN*/
INSERT INTO GIAOVIEN(MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI) VALUES ('001', N'Nguyễn Hoài An', 2000.0, 'Nam', '02/15/1973', N'25/3 Lạc Long Quân, Q.10, TP HCM');

GO
INSERT INTO GIAOVIEN(MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI) VALUES ('002', N'Trần Trà Hương', 2500.0, N'Nữ', '06/20/1960', N'125 Trần Hưng Đạo, Q.1, TP HCM');

GO
INSERT INTO GIAOVIEN(MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI) VALUES ('003', N'Nguyễn Ngọc Ánh', 2200.0, N'Nữ', '05/11/1975', N'12/21 Võ Văn Ngân Thủ Đức, TP HCM');

GO
INSERT INTO GIAOVIEN(MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI) VALUES ('004', N'Trương Nam Sơn', 2300.0, N'Nam', '06/20/1959', N'215 Lý Thường Kiệt, TP Biên Hòa');

GO
INSERT INTO GIAOVIEN(MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI) VALUES ('005', N'Lý Hoàng Hà', 2500.0, N'Nam', '10/23/1954', N'22/5 Nguyễn Xí, Q.Bình Thạnh, TP HCM');

GO
INSERT INTO GIAOVIEN(MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI) VALUES ('006', N'Trần Bạch Tuyết', 1500.0, N'Nữ', '05/20/1980', N'127 Hùng Vương, TP Mỹ Tho');

GO
INSERT INTO GIAOVIEN(MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI) VALUES ('007', N'Nguyễn An Trung', 2100.0, N'Nam', '06/05/1976', N'234 3/2, TP Biên Hòa');

GO
INSERT INTO GIAOVIEN(MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI) VALUES ('008', N'Trần Trung Hiếu', 1800.0, N'Nam', '08/06/1977', N'22/11 Lý Thường Kiệt, TP Mỹ Tho');

GO
INSERT INTO GIAOVIEN(MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI) VALUES ('009', N'Trần Hoàng Nam', 2000.0, N'Nam', '11/22/1975', N'234 Trần Não, An Phú, TP HCM');

GO
INSERT INTO GIAOVIEN(MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI) VALUES ('010', N'Phạm Nam Thanh', 1500.0, N'Nam', '12/12/1980', N'221 Hùng Vương, Q.5, TP HCM');

GO

/*Nhập liệu GV_DT*/
INSERT INTO GV_DT VALUES ('001', '0838912112');
GO

INSERT INTO GV_DT VALUES ('001', '0903123123');
GO

INSERT INTO GV_DT VALUES ('002', '0913454545');
GO

INSERT INTO GV_DT VALUES ('003', '0838121212');
GO

INSERT INTO GV_DT VALUES ('003', '0903656565');
GO

INSERT INTO GV_DT VALUES ('003', '0937125125');
GO

INSERT INTO GV_DT VALUES ('006', '093788888');
GO

INSERT INTO GV_DT VALUES ('008', '0653717171');
GO

INSERT INTO GV_DT VALUES ('008', '0913232323');
GO

/*Nhập liệu KHOA*/
INSERT INTO KHOA VALUES ('CNTT', N'Công nghệ thông tin', '1995', 'B11', '0838123456', '002', '2005-02-20');
INSERT INTO KHOA VALUES ('HH', N'Hóa học', '1980', 'B41', '0838456456', '007', '2001-10-15');
INSERT INTO KHOA VALUES ('SH', N'Sinh học', '1980', 'B31', '0883845454', '004', '2000-10-11');
INSERT INTO KHOA VALUES ('VL', N'Vật Lý', '1976', 'B21', '0838223223', '005', '2003-09-18');

/*Nhập liệu NGUOITHAN*/
INSERT INTO NGUOITHAN VALUES ('001', N'Hùng', '1990-01-14', 'Nam');
INSERT INTO NGUOITHAN VALUES ('001', N'Thủy', '1994-12-08', N'Nữ');
INSERT INTO NGUOITHAN VALUES ('003', N'Hà', '1998-09-03', N'Nữ');
INSERT INTO NGUOITHAN VALUES ('003', N'Thu', '1998-09-03', N'Nữ');
INSERT INTO NGUOITHAN VALUES ('007', N'Mai', '2003-03-26', N'Nữ');
INSERT INTO NGUOITHAN VALUES ('007', N'Vy', '2000-02-14', N'Nữ');
INSERT INTO NGUOITHAN VALUES ('008', N'Nam', '1991-05-06', 'Nam');
INSERT INTO NGUOITHAN VALUES ('009', N'An', '1996-08-19', 'Nam');
INSERT INTO NGUOITHAN VALUES ('010', N'Nguyệt', '2006-01-14', N'Nữ');

/*Nhập liệu BOMON*/
INSERT INTO BOMON(MABM, TENBM, PHONG, DIENTHOAI, MAKHOA) VALUES ('CNTT', N'Công nghệ tri thức', 'B15', '0838126126', 'CNTT');
INSERT INTO BOMON(MABM, TENBM, PHONG, DIENTHOAI, MAKHOA) VALUES ('HHC', N'Hóa hữu cơ', 'B44', '0838222222', 'HH');
INSERT INTO BOMON(MABM, TENBM, PHONG, DIENTHOAI, MAKHOA) VALUES ('HL', N'Hóa lý', 'B42', '0838878787', 'HH');
INSERT INTO BOMON VALUES ('HPT', N'Hóa phân tích', 'B43', '0838777777', '007', 'HH', '2007-10-15');
INSERT INTO BOMON VALUES ('HTTT', N'Hệ thống thông tin', 'B13', '0838125125', '002', 'CNTT', '2004-09-20');
INSERT INTO BOMON VALUES ('MMT', N'Mạng máy tính', 'B16', '0838676767', '001', 'CNTT', '2005-05-15');
INSERT INTO BOMON(MABM, TENBM, PHONG, DIENTHOAI, MAKHOA) VALUES ('SH', N'Sinh hóa', 'B33', '0838898989', 'SH');
INSERT INTO BOMON(MABM, TENBM, PHONG, DIENTHOAI, MAKHOA) VALUES (N'VLĐT', N'Vật lý điện tử', 'B23', '0838234234', 'VL');
INSERT INTO BOMON VALUES ('VLUD', N'Vật lý ứng dụng', 'B24', '0838454545', '005', 'VL', '2006-02-18');
INSERT INTO BOMON VALUES ('VS', N'Vi sinh', 'B32', '0838909090', '004', 'SH', '2007-01-01');

/*Update GIAOVIEN */
UPDATE GIAOVIEN SET MABM = 'MMT' WHERE MAGV = '001';
UPDATE GIAOVIEN SET MABM = 'HTTT' WHERE MAGV = '002';
UPDATE GIAOVIEN SET MABM = 'HTTT', GVQLCM ='002' WHERE MAGV = '003';
UPDATE GIAOVIEN SET MABM = 'VS' WHERE MAGV = '004';
UPDATE GIAOVIEN SET MABM = 'VLĐT' WHERE MAGV = '005';
UPDATE GIAOVIEN SET MABM = 'VS', GVQLCM ='004' WHERE MAGV = '006';
UPDATE GIAOVIEN SET MABM = 'HPT' WHERE MAGV = '007';
UPDATE GIAOVIEN SET MABM = 'HPT', GVQLCM ='007' WHERE MAGV = '008';
UPDATE GIAOVIEN SET MABM = 'MMT', GVQLCM ='001' WHERE MAGV = '009';
UPDATE GIAOVIEN SET MABM = 'HPT', GVQLCM ='007' WHERE MAGV = '010';

/*Nhập dữ liệu cho chủ đề*/
INSERT INTO CHUDE VALUES('NCPT',N'Nghiên cứu phát triển');
INSERT INTO CHUDE VALUES('QLGD',N'Quản lý giáo dục');
INSERT INTO CHUDE VALUES('UDCN',N'Ứng dụng công nghệ');

/*Nhập dữ liệu cho đề tài*/
INSERT INTO DETAI VALUES('001', N'HTTT quản lý các trường ĐH', N'ĐHQG', 20.0, '2007-10-20', '2008-10-20', 'QLGD', '002');
INSERT INTO DETAI VALUES('002', N'HTTT quản lý giáo vụ cho một Khoa', N'Trường', 20.0, '2000-10-12', '2001-10-12', 'QLGD', '002');
INSERT INTO DETAI VALUES('003', N'Nghiên cứu chế tạo sợi Nanô Platin', N'ĐHQG', 300.0, '2008-05-15', '2010-05-15', 'NCPT', '005');
INSERT INTO DETAI VALUES('004', N'Tạo vật liệu sinh học bằng màng ối người', N'Nhà nước', 100.0, '2007-01-01', '2009-12-31', 'NCPT', '004');
INSERT INTO DETAI VALUES('005', N'Ứng dụng hóa học xanh', N'Trường', 200.0, '2003-10-10', '2004-12-10', 'UDCN', '007');
INSERT INTO DETAI VALUES('006', N'Nghiên cứu tế bào gốc', N'Nhà nước', 4000.0, '2006-10-20', '2009-10-20', 'NCPT', '004');
INSERT INTO DETAI VALUES('007', N'HTTT quản lý thư viện ở các trường ĐH', N'Trường', 20.0, '2009-05-10', '2010-05-10', 'QLGD', '001');

/*Nhập dữ liệu cho công việc*/
INSERT INTO CONGVIEC VALUES ('001', 1, N'Khởi tạo và Lập kế hoạch', '2007-10-20', '2008-12-20');
INSERT INTO CONGVIEC VALUES ('001', 2, N'Xác định yêu cầu', '2008-12-21', '2008-03-21');
INSERT INTO CONGVIEC VALUES ('001', 3, N'Phân tích hệ thống', '2008-03-22', '2008-05-22');
INSERT INTO CONGVIEC VALUES ('001', 4, N'Thiết kế hệ thống', '2008-05-23', '2008-06-23');
INSERT INTO CONGVIEC VALUES ('001', 5, N'Cài đặt thử nghiệm', '2008-06-24', '2008-10-20');
INSERT INTO CONGVIEC VALUES ('002', 1, N'Khởi tạo và Lập kế hoạch', '2009-05-10', '2009-07-10');
INSERT INTO CONGVIEC VALUES ('002', 2, N'Xác định yêu cầu', '2009-07-11', '2009-10-11');
INSERT INTO CONGVIEC VALUES ('002', 3, N'Phân tích hệ thống', '2009-10-12', '2009-12-20');
INSERT INTO CONGVIEC VALUES ('002', 4, N'Thiết kế hệ thống', '2009-12-21', '2010-03-22');
INSERT INTO CONGVIEC VALUES ('002', 5, N'Cài đặt thử nghiệm', '2010-03-23', '2010-05-10');
INSERT INTO CONGVIEC VALUES ('006', 1, N'Lấy mẫu', '2006-10-20', '2007-02-20');
INSERT INTO CONGVIEC VALUES ('006', 2, N'Nuôi cấy', '2007-02-21', '2008-08-21');

/*Nhập dữ liệu THAMGIADT*/
INSERT INTO THAMGIADT VALUES ('001', '002', 1, 0.0, NULL);
INSERT INTO THAMGIADT VALUES ('001', '002', 2, 2.0, NULL);
INSERT INTO THAMGIADT VALUES ('002', '001', 4, 2.0, N'Đạt');
INSERT INTO THAMGIADT VALUES ('003', '001', 1, 1.0, N'Đạt');
INSERT INTO THAMGIADT VALUES ('003', '001', 2, 0.0, N'Đạt');
INSERT INTO THAMGIADT VALUES ('003', '001', 4, 1.0, N'Đạt');
INSERT INTO THAMGIADT VALUES ('003', '002', 2, 0.0, NULL);
INSERT INTO THAMGIADT VALUES ('004', '006', 1, 0.0, N'Đạt');
INSERT INTO THAMGIADT VALUES ('004', '006', 2, 1.0, N'Đạt');
INSERT INTO THAMGIADT VALUES ('006', '006', 2, 1.5, N'Đạt');
INSERT INTO THAMGIADT VALUES ('009', '002', 3, 0.5, NULL);
INSERT INTO THAMGIADT VALUES ('009', '002', 4, 1.5, NULL);


















